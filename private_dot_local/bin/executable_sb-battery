#!/bin/sh
case $BLOCK_BUTTON in
	1) dunstify -a "sb-battery" -u low -r 2222 -t 10000 "ðŸ”‹ Battery module" "ó°¾ discharging
ó°¢ charging
Scroll to change adjust brightness." ;;
	4) changebright up 2 ;;
	5) changebright down 2 ;;
	6) "kitty" -e "nvim" "$0" ;;
esac

battery="/sys/class/power_supply/BAT0"
capacity="$(cat "$battery/capacity" 2>&1)"
power="$(echo - | awk "{printf \"%.1f\", \
		$(( $(cat "$battery/current_now" 2>/dev/null || echo 0) * \
 			$(cat "$battery/voltage_now" 2>/dev/null || echo 1) \
			)) / 1000000000000 }")"

# Sets up the status and capacity
case "$(cat "$battery/status" 2>&1)" in
	"Discharging"|"Not charging")
		power="-$power"
		case 1 in
			$((capacity < 10)) ) status="ó±ƒ"  ;; # 0-9
			$((capacity < 20)) ) status="ó°º"  ;; # 10-19 
			$((capacity < 30)) ) status="ó°»"  ;; # 20-29
			$((capacity < 40)) ) status="ó°¼"  ;; # 30-39
			$((capacity < 50)) ) status="ó°½"  ;; # 40-49
			$((capacity < 60)) ) status="ó°¾"  ;; # 50-59
			$((capacity < 70)) ) status="ó°¿"  ;; # 60-69
			$((capacity < 80)) ) status="ó°‚€"  ;; # 70-79
			$((capacity < 90)) ) status="ó°‚"  ;; # 80-89
			$((capacity < 100)) ) status="ó°‚‚" ;; # 90-99
			* ) status="ó°¹" 					 ;; # 100
		esac
		;;	
	"Full"|"Charging")
		case 1 in
			$((capacity < 10)) ) status="ó°¢œ"  ;; # 0-9
			$((capacity < 20)) ) status="ó°¢œ"  ;; # 10-19 
			$((capacity < 30)) ) status="ó°‚†"  ;; # 20-29
			$((capacity < 40)) ) status="ó°‚‡"  ;; # 30-39
			$((capacity < 50)) ) status="ó°‚ˆ"  ;; # 40-49
			$((capacity < 60)) ) status="ó°¢"  ;; # 50-59
			$((capacity < 70)) ) status="ó°‚‰"  ;; # 60-69
			$((capacity < 80)) ) status="ó°¢ž"  ;; # 70-79
			$((capacity < 90)) ) status="ó°‚Š"  ;; # 80-89
			$((capacity < 100)) ) status="ó°‚‹" ;; # 90-99
			* ) status="ó°‚…" 					 ;; # 100
		esac
		;;
	"Unknown") status="ó°‚‘" ;;
	*) exit 1 ;;
esac

# Prints the info
printf "%s%d%% %.1fW\n" "$status" "$capacity" "$power"; unset warn
